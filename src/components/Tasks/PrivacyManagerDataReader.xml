<?xml version = "1.0" encoding = "utf-8" ?>

<component name = "PrivacyManagerDataReader" extends = "Task" >

  <interface>
    <field id = "privacyManagerData" type = "string" />
  </interface>

  <script type = "text/brightscript" >

    <![CDATA[
        sub init()
            m.top.functionName = "getPrivacyManagerData"
        end sub

        sub getPrivacyManagerData()
            pmData = createObject("roSGNode", "ContentNode")
            urlTransferObj = createObject("roUrlTransfer")
            urlTransferObj.SetCertificatesFile("common:/certs/ca-bundle.crt")
            urlTransferObj.AddHeader("X-Roku-Reserved-Dev-Id", "")
            urlTransferObj.InitClientCertificates()
            url = "https://sourcepoint.mgr.consensu.org/privacy-manager/slim/" + m.global.privacy_manager_id
            urlTransferObj.setUrl(url)
            pmData = urlTransferObj.GetToString()
            m.top.privacyManagerData = pmData
        end sub
    ]]>

  </script>

</component>
